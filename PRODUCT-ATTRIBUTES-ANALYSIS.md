# ØªØ­Ù„ÛŒÙ„ Ø³ÛŒØ³ØªÙ… ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒØ¯Ù‡ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Variants

> **ÙˆØ¶Ø¹ÛŒØª:** âœ… Ø¢Ù…Ø§Ø¯Ù‡ ØªØ§ÛŒÛŒØ¯ Ùˆ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ  
> **ØªØ§Ø±ÛŒØ®:** 20 Ù†ÙˆØ§Ù…Ø¨Ø± 2025  
> **Ù†Ø³Ø®Ù‡:** 2.0 (Revised)

---

## ğŸ“Œ Ø®Ù„Ø§ØµÙ‡ Ø§Ø¬Ø±Ø§ÛŒÛŒ (Executive Summary)

### ğŸ¯ Ù‡Ø¯Ù
Ø·Ø±Ø§Ø­ÛŒ Ùˆ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÛŒÚ© Ø³ÛŒØ³ØªÙ… **Product Attributes** Ùˆ **Variant-Based Inventory Management** Ú©Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯:

1. **ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡** ØªØ¹Ø±ÛŒÙ Ú©Ù†Ù†Ø¯ (Ø³Ø§ÛŒØ²ØŒ Ø±Ù†Ú¯ØŒ Ø¬Ù†Ø³ØŒ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ùˆ ...)
2. **Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡** Ù‡Ø± ÙˆÛŒÚ˜Ú¯ÛŒ Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù†Ù†Ø¯ (Ù…ØªÙ†ØŒ Ø¹Ø¯Ø¯ØŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒØŒ Ø±Ù†Ú¯ Ùˆ ...)
3. ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ **ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡** ÛŒØ§ **Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡** Ø¨Ø§Ø´Ù†Ø¯
4. ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ **Ø«Ø§Ø¨Øª** (Ø¯Ø± Ø³Ø·Ø­ Ù…Ø­ØµÙˆÙ„) ÛŒØ§ **Ù…ØªØºÛŒØ±** (Ø¯Ø± Ø³Ø·Ø­ Variant) Ø¨Ø§Ø´Ù†Ø¯
5. **Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø¬Ø²Ø§** Ø¨Ø±Ø§ÛŒ Ù‡Ø± ØªØ±Ú©ÛŒØ¨ ÙˆÛŒÚ˜Ú¯ÛŒ (Variant) Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù†Ø¯
6. **Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„** ÙØ±ÙˆØ´ Ùˆ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§

### ğŸ† Ù†ÙˆØ¢ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ

| ÙˆÛŒÚ˜Ú¯ÛŒ | ØªÙˆØ¶ÛŒØ­ | Ù…Ø«Ø§Ù„ |
|-------|-------|------|
| **Cardinality** | ØªÚ© ÛŒØ§ Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡ | Ø¬Ù†Ø³: ["Ù¾Ù†Ø¨Ù‡", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±"] |
| **Scope** | Ø«Ø§Ø¨Øª ÛŒØ§ Ù…ØªØºÛŒØ± | Ø¬Ù†Ø³: Ø«Ø§Ø¨Øª / Ø³Ø§ÛŒØ²: Ù…ØªØºÛŒØ± |
| **Variant Snapshot** | Ø°Ø®ÛŒØ±Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡ ÙØ±ÙˆØ´ | SKU + ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø¯Ø± ÙØ§Ú©ØªÙˆØ± |
| **Stock Transaction** | Audit Trail Ù…ÙˆØ¬ÙˆØ¯ÛŒ | Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„ ØªØºÛŒÛŒØ±Ø§Øª |
| **Backward Compatible** | Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ¹Ù„ÛŒ | hasVariants = true/false |

### ğŸ“Š Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø¯Ø± ÛŒÚ© Ù†Ú¯Ø§Ù‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ProductAttribute                    â”‚
â”‚  (ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§: Ø³Ø§ÛŒØ²ØŒ Ø±Ù†Ú¯ØŒ Ø¬Ù†Ø³ Ùˆ ...)            â”‚
â”‚  - DataType: TEXT, NUMBER, SELECT, COLOR            â”‚
â”‚  - Cardinality: SINGLE / MULTIPLE âœ¨                â”‚
â”‚  - Scope: PRODUCT_LEVEL / VARIANT_LEVEL âœ¨          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                  â”‚
     â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Product    â”‚   â”‚ProductVariantâ”‚
â”‚ Attributes  â”‚   â”‚  Attributes  â”‚
â”‚  (Ø«Ø§Ø¨Øª)     â”‚   â”‚   (Ù…ØªØºÛŒØ±)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ InvoiceItem  â”‚
                  â”‚ + variantId âœ¨â”‚
                  â”‚ + snapshot  âœ¨â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### âœ… Ù…Ø´Ú©Ù„Ø§Øª Ø­Ù„ Ø´Ø¯Ù‡

1. **ØªØ¯Ø§Ø®Ù„ Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ø§Ù†Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒ:** Ø¨Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† `variantId` Ø¨Ù‡ `InvoiceItem` Ø­Ù„ Ø´Ø¯
2. **ØªÚ© vs Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ:** Ø¨Ø§ `AttributeCardinality` Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
3. **ÙˆÛŒÚ˜Ú¯ÛŒ Ø«Ø§Ø¨Øª vs Ù…ØªØºÛŒØ±:** Ø¨Ø§ `AttributeScope` ØªÙÚ©ÛŒÚ© Ø´Ø¯Ù†Ø¯
4. **Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¯Ù‚ÛŒÙ‚ Ù…ÙˆØ¬ÙˆØ¯ÛŒ:** Ø¨Ø§ `StockTransaction` Ùˆ `variantSnapshot` Ø­Ù„ Ø´Ø¯
5. **Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ú¯Ø°Ø´ØªÙ‡:** Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ¹Ù„ÛŒ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯

---

## ğŸ”´ Ù†Ù‚Ø¯ Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª (Critical Review)

### âœ… Ù†Ú©Ø§Øª ØµØ­ÛŒØ­ Ø¯Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª:
1. **ØªÚ© Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ vs Ú†Ù†Ø¯Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ**: Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø¯Ø±Ø³Øª Ø§Ø³Øª! Ø¨Ø±Ø®ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ ÙÙ‚Ø· ÛŒÚ© Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø§Ø±Ù†Ø¯ (Ø¬Ù†Ø³=Ù¾Ù†Ø¨Ù‡) Ùˆ Ø¨Ø±Ø®ÛŒ Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø± (Ø±Ù†Ú¯=Ø¢Ø¨ÛŒ+Ø³ÙÛŒØ¯)
2. **Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ**: Ù‡Ø± Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ÛŒØ¯ Ø¨ØªÙˆØ§Ù†Ø¯ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡Ø´ Ø±Ø§ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
3. **Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ ØªØ±Ú©ÛŒØ¨**: Ù‡Ø± Variant Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø¬Ø²Ø§ Ø¯Ø§Ø±Ø¯

### ğŸ”´ Ù…Ø´Ú©Ù„Ø§Øª Ø§Ø­ØªÙ…Ø§Ù„ÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø­Ù„ Ø´ÙˆÙ†Ø¯:

#### 1ï¸âƒ£ **ØªØ¯Ø§Ø®Ù„ Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ø§Ù†Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒ (CRITICAL)**

**Ù…Ø´Ú©Ù„:** Ø¯Ø± Ø³ÛŒØ³ØªÙ… ÙØ¹Ù„ÛŒ:
- ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ (`invoice_items`) Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¨Ù‡ `productId` Ù…ØªØµÙ„ Ù‡Ø³ØªÙ†Ø¯
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ø³Ø·Ø­ Ù…Ø­ØµÙˆÙ„ (`Product.currentStock`) Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ú¯Ø± Variant Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒÙ…ØŒ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù‡ Ù‡Ù… Ù…ÛŒâ€ŒØ±ÛŒØ²Ø¯!

**Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ù…Ø´Ú©Ù„:**
```
1. ÙØ±ÙˆØ´: ØªÛŒâ€ŒØ´Ø±Øª Ø³Ø§ÛŒØ² L Ø±Ù†Ú¯ Ø¢Ø¨ÛŒ (2 Ø¹Ø¯Ø¯)
2. Ø³ÛŒØ³ØªÙ… ÙØ¹Ù„ÛŒ: Ø§Ø² Product.currentStock Ú©Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (âŒ Ø§Ø´ØªØ¨Ø§Ù‡!)
3. Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯: Ø¨Ø§ÛŒØ¯ Ø§Ø² Variant Ø®Ø§Øµ Ú©Ù… Ú©Ù†Ø¯ (âœ… Ø¯Ø±Ø³Øª)
```

**Ø±Ø§Ù‡Ú©Ø§Ø±:**
```typescript
// invoice_items Ø¨Ø§ÛŒØ¯ variantId Ù‡Ù… Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
@Entity('invoice_items')
class InvoiceItem {
  productId: string;           // Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
  variantId?: string;          // âœ¨ Ø¬Ø¯ÛŒØ¯: Variant Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
  variantDetails?: JSON;       // âœ¨ Ø¬Ø¯ÛŒØ¯: Ø°Ø®ÛŒØ±Ù‡ snapshot ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
  // ...
}
```

#### 2ï¸âƒ£ **Cardinality (ØªÚ©/Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ) Ø¯Ø± Attribute**

**Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´Ù…Ø§ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¯Ø±Ø³Øª Ø§Ø³Øª!** Ø¨Ø§ÛŒØ¯ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒÙ…:

```typescript
enum AttributeCardinality {
  SINGLE = 'single',        // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±: Ø¬Ù†Ø³ = "Ù¾Ù†Ø¨Ù‡"
  MULTIPLE = 'multiple',    // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±: Ø±Ù†Ú¯ = ["Ø¢Ø¨ÛŒ", "Ø³ÙÛŒØ¯"]
}

@Entity('product_attributes')
class ProductAttribute {
  // ...
  cardinality: AttributeCardinality;  // âœ¨ ØªÚ© ÛŒØ§ Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ
  
  // Ø¨Ø±Ø§ÛŒ SELECT Ùˆ MULTI_SELECT
  allowCustomValue: boolean;          // âœ¨ Ø¢ÛŒØ§ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù„Ø®ÙˆØ§Ù‡ Ù…Ø¬Ø§Ø² Ø§Ø³ØªØŸ
}
```

#### 3ï¸âƒ£ **Fixed vs Variable Attributes (Ø«Ø§Ø¨Øª vs Ù…ØªØºÛŒØ±)**

**Ù…Ø´Ú©Ù„:** Ø¨Ø±Ø®ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø«Ø§Ø¨Øª Ù‡Ø³ØªÙ†Ø¯ (Ø¬Ù†Ø³ Ù‡Ù…ÛŒØ´Ù‡ Ù¾Ù†Ø¨Ù‡) Ùˆ Ø¨Ø±Ø®ÛŒ Ø¯Ø± VariantÙ‡Ø§ Ù…ØªØºÛŒØ±Ù†Ø¯ (Ø³Ø§ÛŒØ² Ùˆ Ø±Ù†Ú¯)

**Ø±Ø§Ù‡Ú©Ø§Ø±:**
```typescript
enum AttributeScope {
  PRODUCT_LEVEL = 'product_level',    // Ø«Ø§Ø¨Øª Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ (Ù…Ø«Ù„ Ø¬Ù†Ø³)
  VARIANT_LEVEL = 'variant_level',    // Ù…ØªØºÛŒØ± Ø¯Ø± Variants (Ù…Ø«Ù„ Ø³Ø§ÛŒØ²)
}

@Entity('product_attributes')
class ProductAttribute {
  scope: AttributeScope;  // âœ¨ ØªØ¹ÛŒÛŒÙ† Ø³Ø·Ø­
}
```

**Ù…Ø«Ø§Ù„:**
```
Ù…Ø­ØµÙˆÙ„: ØªÛŒâ€ŒØ´Ø±Øª
â”œâ”€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª (Product-level):
â”‚  â””â”€ Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡
â””â”€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± (Variant-level):
   â”œâ”€ Ø³Ø§ÛŒØ²: S, M, L, XL
   â””â”€ Ø±Ù†Ú¯: Ø¢Ø¨ÛŒ, Ù‚Ø±Ù…Ø², Ø³ÙÛŒØ¯
   
Variants:
â”œâ”€ V1: [Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡] + Ø³Ø§ÛŒØ²: S + Ø±Ù†Ú¯: Ø¢Ø¨ÛŒ
â”œâ”€ V2: [Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡] + Ø³Ø§ÛŒØ²: M + Ø±Ù†Ú¯: Ø¢Ø¨ÛŒ
â””â”€ V3: [Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡] + Ø³Ø§ÛŒØ²: L + Ø±Ù†Ú¯: Ù‚Ø±Ù…Ø²
```

---

## ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª (Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡)

ÛŒÚ© Ø³ÛŒØ³ØªÙ… **Product Attributes** Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª **Variant-Based Inventory Management** Ú©Ù‡:

1. **ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡** Ø¨Ø§ ØªØ¹ÛŒÛŒÙ† Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ØŒ ØªÚ©/Ú†Ù†Ø¯Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒØŒ Ùˆ Ø³Ø·Ø­ (Ø«Ø§Ø¨Øª/Ù…ØªØºÛŒØ±)
2. **ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª** Ø¯Ø± Ø³Ø·Ø­ Ù…Ø­ØµÙˆÙ„ (Ù…Ø«Ù„ Ø¬Ù†Ø³)
3. **ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±** Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Variants (Ù…Ø«Ù„ Ø³Ø§ÛŒØ² Ùˆ Ø±Ù†Ú¯)
4. **Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø³ØªÙ‚Ù„** Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant
5. **Ø§Ø¯ØºØ§Ù… Ø¨Ø§ Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§** Ø¨Ø±Ø§ÛŒ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¯Ù‚ÛŒÙ‚
6. **Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ¹Ù„ÛŒ** (Ø¨Ø¯ÙˆÙ† Variant)

---

## ğŸ¯ Ù…Ø«Ø§Ù„ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ (Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡)

### Ù…Ø­ØµÙˆÙ„: ØªÛŒâ€ŒØ´Ø±Øª Ù…Ø±Ø¯Ø§Ù†Ù‡

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª (Product-level):
```
Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡ (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡ØŒ Ù‡Ù…Ù‡ VariantÙ‡Ø§ Ø§ÛŒÙ† Ø¬Ù†Ø³ Ø¯Ø§Ø±Ù†Ø¯)
Ø¨Ø±Ù†Ø¯: Nike
Ú©Ø´ÙˆØ± Ø³Ø§Ø²Ù†Ø¯Ù‡: ØªØ±Ú©ÛŒÙ‡
```

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± (Variant-level):
```
Ø³Ø§ÛŒØ²: S, M, L, XL, XXL (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡ØŒ Ù‡Ø± Variant ÛŒÚ© Ø³Ø§ÛŒØ²)
Ø±Ù†Ú¯: Ø¢Ø¨ÛŒ, Ù‚Ø±Ù…Ø², Ø³ÙÛŒØ¯, Ù…Ø´Ú©ÛŒ (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡ØŒ Ù‡Ø± Variant ÛŒÚ© Ø±Ù†Ú¯)
```

#### Variants (ØªØ±Ú©ÛŒØ¨Ø§Øª) Ø¨Ø§ Ù…ÙˆØ¬ÙˆØ¯ÛŒ:

| ID | Ø³Ø§ÛŒØ² | Ø±Ù†Ú¯ | SKU | Ù…ÙˆØ¬ÙˆØ¯ÛŒ | Ù‚ÛŒÙ…Øª |
|----|------|-----|-----|--------|------|
| V1 | S | Ø¢Ø¨ÛŒ | TSH-S-BLU | 5 | 150,000 |
| V2 | M | Ø¢Ø¨ÛŒ | TSH-M-BLU | 10 | 150,000 |
| V3 | L | Ø¢Ø¨ÛŒ | TSH-L-BLU | 8 | 160,000 |
| V4 | XL | Ø¢Ø¨ÛŒ | TSH-XL-BLU | 3 | 170,000 |
| V5 | S | Ù‚Ø±Ù…Ø² | TSH-S-RED | 12 | 150,000 |
| V6 | M | Ù‚Ø±Ù…Ø² | TSH-M-RED | 0 | 150,000 |
| V7 | L | Ø³ÙÛŒØ¯ | TSH-L-WHT | 15 | 160,000 |

**Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ Ù…Ø­ØµÙˆÙ„** = 5+10+8+3+12+0+15 = 53 Ø¹Ø¯Ø¯

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ø¬Ù†Ø³ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ÛŒÚ©Ø³Ø§Ù† Ø§Ø³Øª (Ù¾Ù†Ø¨Ù‡) â†’ ÙˆÛŒÚ˜Ú¯ÛŒ Ø«Ø§Ø¨Øª
- Ø³Ø§ÛŒØ² Ùˆ Ø±Ù†Ú¯ Ø¯Ø± Ù‡Ø± Variant Ù…ØªÙØ§ÙˆØª â†’ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±
- Ù‡Ø± Variant Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ù‚ÛŒÙ…Øª Ù…Ø³ØªÙ‚Ù„ Ø¯Ø§Ø±Ø¯

---

## ğŸ¯ Ù…Ø«Ø§Ù„ Ù¾ÛŒÚ†ÛŒØ¯Ù‡â€ŒØªØ±: Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ

### Ù…Ø­ØµÙˆÙ„: Ú©ÙØ´ ÙˆØ±Ø²Ø´ÛŒ

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª:
```
Ø¨Ø±Ù†Ø¯: Adidas
Ù†ÙˆØ¹: Ú©ØªØ§Ù†ÛŒ ÙˆØ±Ø²Ø´ÛŒ
Ø¬Ù†Ø³ Ø±ÙˆÛŒÙ‡: Ú†Ø±Ù… Ù…ØµÙ†ÙˆØ¹ÛŒ + Ù¾Ø§Ø±Ú†Ù‡ (Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡!) âœ¨
```

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±:
```
Ø³Ø§ÛŒØ²: 38, 39, 40, 41, 42, 43
Ø±Ù†Ú¯ Ø§ØµÙ„ÛŒ: Ù…Ø´Ú©ÛŒ, Ø³ÙÛŒØ¯, Ø¢Ø¨ÛŒ
Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ: [Ù…Ø´Ú©ÛŒ+Ù‚Ø±Ù…Ø²], [Ø³ÙÛŒØ¯+Ø¢Ø¨ÛŒ] (Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡!) âœ¨
```

**Variant Ù†Ù…ÙˆÙ†Ù‡:**
```json
{
  "variantId": "V1",
  "sku": "SHOE-42-BLK-RED",
  "attributes": {
    // Ø«Ø§Ø¨Øª (Ø§Ø² Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ Ø§Ø±Ø«â€ŒØ¨Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯)
    "brand": "Adidas",
    "material": ["Ú†Ø±Ù… Ù…ØµÙ†ÙˆØ¹ÛŒ", "Ù¾Ø§Ø±Ú†Ù‡"],  // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡
    
    // Ù…ØªØºÛŒØ± (Ù…Ø®ØµÙˆØµ Ø§ÛŒÙ† Variant)
    "size": 42,                              // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡
    "colors": ["Ù…Ø´Ú©ÛŒ", "Ù‚Ø±Ù…Ø²"]              // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡
  },
  "stock": 8,
  "price": 2500000
}
```

---

## ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ (Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡)

### 1ï¸âƒ£ **ProductAttribute** (ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§)

Ø¬Ø¯ÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±

```typescript
enum AttributeDataType {
  TEXT = 'text',                 // Ù…ØªÙ† Ø¢Ø²Ø§Ø¯
  NUMBER = 'number',             // Ø¹Ø¯Ø¯
  SELECT = 'select',             // Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø² Ù„ÛŒØ³Øª (ØªÚ© ÛŒØ§ Ú†Ù†Ø¯)
  COLOR = 'color',               // Ø±Ù†Ú¯ (HEX code)
  BOOLEAN = 'boolean',           // Ø¨Ù„Ù‡/Ø®ÛŒØ±
  DATE = 'date',                 // ØªØ§Ø±ÛŒØ®
}

enum AttributeCardinality {
  SINGLE = 'single',             // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±
  MULTIPLE = 'multiple',         // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±
}

enum AttributeScope {
  PRODUCT_LEVEL = 'product_level',   // Ø«Ø§Ø¨Øª Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Variants
  VARIANT_LEVEL = 'variant_level',   // Ù…ØªØºÛŒØ± Ø¯Ø± Ù‡Ø± Variant
}

@Entity('product_attributes')
class ProductAttribute {
  @PrimaryGeneratedColumn('uuid')
  id: string;
  
  @Column({ type: 'uuid' })
  @Index()
  businessId: string;
  
  // Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ
  @Column({ type: 'varchar', length: 100 })
  name: string;                  // Ù†Ø§Ù… ÙØ§Ø±Ø³ÛŒ: "Ø±Ù†Ú¯", "Ø³Ø§ÛŒØ²"
  
  @Column({ type: 'varchar', length: 100, nullable: true })
  nameEn: string;                // Ù†Ø§Ù… Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ: "Color", "Size"
  
  @Column({ type: 'varchar', length: 50 })
  @Index()
  code: string;                  // Ú©Ø¯ ÛŒÙˆÙ†ÛŒÚ©: "color", "size"
  
  // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡
  @Column({
    type: 'enum',
    enum: AttributeDataType,
    default: AttributeDataType.TEXT,
  })
  dataType: AttributeDataType;   // Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡
  
  @Column({
    type: 'enum',
    enum: AttributeCardinality,
    default: AttributeCardinality.SINGLE,
  })
  cardinality: AttributeCardinality;  // âœ¨ ØªÚ© ÛŒØ§ Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ
  
  @Column({
    type: 'enum',
    enum: AttributeScope,
    default: AttributeScope.VARIANT_LEVEL,
  })
  scope: AttributeScope;         // âœ¨ Ø³Ø·Ø­ Ù…Ø­ØµÙˆÙ„ ÛŒØ§ Variant
  
  // Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ù…Ú©Ù† (Ø¨Ø±Ø§ÛŒ SELECT)
  @Column({ type: 'jsonb', nullable: true })
  options: {
    value: string;               // Ù…Ù‚Ø¯Ø§Ø±
    label: string;               // Ø¨Ø±Ú†Ø³Ø¨ Ù†Ù…Ø§ÛŒØ´ÛŒ
    color?: string;              // Ø±Ù†Ú¯ (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ UI)
    sortOrder?: number;          // ØªØ±ØªÛŒØ¨
  }[];
  
  @Column({ type: 'boolean', default: false })
  allowCustomValue: boolean;     // âœ¨ Ù…Ø¬Ø§Ø² Ø¨ÙˆØ¯Ù† Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù„Ø®ÙˆØ§Ù‡
  
  // Validation
  @Column({ type: 'boolean', default: false })
  required: boolean;             // Ø§Ø¬Ø¨Ø§Ø±ÛŒ
  
  @Column({ type: 'decimal', precision: 15, scale: 2, nullable: true })
  minValue: number;              // Ø­Ø¯Ø§Ù‚Ù„ (Ø¨Ø±Ø§ÛŒ NUMBER)
  
  @Column({ type: 'decimal', precision: 15, scale: 2, nullable: true })
  maxValue: number;              // Ø­Ø¯Ø§Ú©Ø«Ø± (Ø¨Ø±Ø§ÛŒ NUMBER)
  
  @Column({ type: 'varchar', length: 200, nullable: true })
  pattern: string;               // Regex pattern
  
  @Column({ type: 'text', nullable: true })
  description: string;           // ØªÙˆØ¶ÛŒØ­Ø§Øª
  
  @Column({ type: 'text', nullable: true })
  helpText: string;              // Ø±Ø§Ù‡Ù†Ù…Ø§ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
  
  // UI Settings
  @Column({ type: 'integer', default: 0 })
  sortOrder: number;             // ØªØ±ØªÛŒØ¨ Ù†Ù…Ø§ÛŒØ´
  
  @Column({ type: 'varchar', length: 50, nullable: true })
  displayFormat: string;         // ÙØ±Ù…Øª Ù†Ù…Ø§ÛŒØ´ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø±Ø§ÛŒ Ø¹Ø¯Ø¯)
  
  @Column({ type: 'varchar', length: 50, nullable: true })
  icon: string;                  // Ø¢ÛŒÚ©ÙˆÙ†
  
  // Status
  @Column({ type: 'boolean', default: true })
  isActive: boolean;             // ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„
  
  @CreateDateColumn()
  createdAt: Date;
  
  @UpdateDateColumn()
  updatedAt: Date;
  
  // Relations
  @ManyToOne(() => Business, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'businessId' })
  business: Business;
}
```

---

### 2ï¸âƒ£ **ProductAttributeValue** (Ù…Ù‚Ø§Ø¯ÛŒØ± ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„)

ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª Ø¯Ø± Ø³Ø·Ø­ Ù…Ø­ØµÙˆÙ„ (Product-level)

```typescript
@Entity('product_attribute_values')
class ProductAttributeValue {
  @PrimaryGeneratedColumn('uuid')
  id: string;
  
  @Column({ type: 'uuid' })
  @Index()
  productId: string;
  
  @Column({ type: 'uuid' })
  @Index()
  attributeId: string;
  
  // Ø°Ø®ÛŒØ±Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ Ùˆ cardinality
  @Column({ type: 'jsonb' })
  value: any;  // Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯: string, number, string[], boolean, Date
  
  /*
  Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§:
  - TEXT (single):           { "value": "Ù¾Ù†Ø¨Ù‡" }
  - NUMBER (single):         { "value": 250 }
  - SELECT (single):         { "value": "large" }
  - SELECT (multiple):       { "value": ["cotton", "polyester"] }
  - COLOR (single):          { "value": "#FF0000" }
  - COLOR (multiple):        { "value": ["#FF0000", "#0000FF"] }
  - BOOLEAN:                 { "value": true }
  - DATE:                    { "value": "2024-01-15" }
  */
  
  @Column({ type: 'integer', default: 0 })
  sortOrder: number;
  
  @CreateDateColumn()
  createdAt: Date;
  
  @UpdateDateColumn()
  updatedAt: Date;
  
  // Relations
  @ManyToOne(() => Product, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'productId' })
  product: Product;
  
  @ManyToOne(() => ProductAttribute, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'attributeId' })
  attribute: ProductAttribute;
  
  // Unique constraint
  @Index(['productId', 'attributeId'], { unique: true })
}
```

---

### 3ï¸âƒ£ **ProductVariant** (ØªØ±Ú©ÛŒØ¨Ø§Øª Ù…Ø­ØµÙˆÙ„)

```typescript
enum VariantStatus {
  IN_STOCK = 'in_stock',           // Ù…ÙˆØ¬ÙˆØ¯
  LOW_STOCK = 'low_stock',         // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…
  OUT_OF_STOCK = 'out_of_stock',   // Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯
  DISCONTINUED = 'discontinued',    // Ù…ØªÙˆÙ‚Ù Ø´Ø¯Ù‡
}

@Entity('product_variants')
class ProductVariant {
  @PrimaryGeneratedColumn('uuid')
  id: string;
  
  @Column({ type: 'uuid' })
  @Index()
  productId: string;
  
  @Column({ type: 'uuid' })
  @Index()
  businessId: string;
  
  // Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ
  @Column({ type: 'varchar', length: 100, unique: true })
  @Index()
  sku: string;                   // âœ¨ SKU ÛŒÙˆÙ†ÛŒÚ© (Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Variant)
  
  @Column({ type: 'varchar', length: 100, nullable: true })
  barcode: string;
  
  @Column({ type: 'varchar', length: 200, nullable: true })
  name: string;                  // Ù†Ø§Ù… Ø§Ø®ØªØµØ§ØµÛŒ (Ù…Ø«Ù„Ø§Ù‹ "ØªÛŒâ€ŒØ´Ø±Øª Ø³Ø§ÛŒØ² L Ø¢Ø¨ÛŒ")
  
  // ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± (Variant-level attributes)
  @Column({ type: 'jsonb' })
  attributes: Record<string, any>;
  /*
  Ù…Ø«Ø§Ù„:
  {
    "size": "L",                    // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡
    "color": "#0000FF",             // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡
    "features": ["waterproof", "breathable"]  // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡
  }
  */
  
  // Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  @Column({ type: 'decimal', precision: 15, scale: 3, default: 0 })
  currentStock: number;          // âœ¨ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ Ø§ÛŒÙ† Variant
  
  @Column({ type: 'decimal', precision: 15, scale: 3, default: 0 })
  minStock: number;              // Ø­Ø¯Ø§Ù‚Ù„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  
  @Column({ type: 'decimal', precision: 15, scale: 3, nullable: true })
  reorderPoint: number;          // Ù†Ù‚Ø·Ù‡ Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯
  
  // Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ (ØªÙØ§ÙˆØª Ø¨Ø§ Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ)
  @Column({ type: 'decimal', precision: 15, scale: 2, default: 0 })
  priceAdjustment: number;       // âœ¨ ØªÙØ§ÙˆØª Ù‚ÛŒÙ…Øª (+ ÛŒØ§ -)
  
  @Column({ type: 'decimal', precision: 15, scale: 2, default: 0 })
  purchasePriceAdjustment: number;
  
  // ÛŒØ§ Ù‚ÛŒÙ…Øª Ù…Ø·Ù„Ù‚
  @Column({ type: 'decimal', precision: 15, scale: 2, nullable: true })
  salePrice: number;             // Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ (Ø§Ú¯Ø± nullØŒ Ø§Ø² Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ)
  
  @Column({ type: 'decimal', precision: 15, scale: 2, nullable: true })
  purchasePrice: number;
  
  // ØªØµØ§ÙˆÛŒØ±
  @Column({ type: 'varchar', length: 500, nullable: true })
  mainImage: string;
  
  @Column({ type: 'simple-array', nullable: true })
  images: string[];
  
  // Ø§Ø¨Ø¹Ø§Ø¯ Ùˆ ÙˆØ²Ù†
  @Column({ type: 'decimal', precision: 10, scale: 3, nullable: true })
  weight: number;
  
  @Column({ type: 'jsonb', nullable: true })
  dimensions: {
    length?: number;
    width?: number;
    height?: number;
    unit?: string;
  };
  
  // ÙˆØ¶Ø¹ÛŒØª
  @Column({ type: 'boolean', default: true })
  isActive: boolean;
  
  @Column({
    type: 'enum',
    enum: VariantStatus,
    default: VariantStatus.IN_STOCK,
  })
  status: VariantStatus;
  
  @Column({ type: 'integer', default: 0 })
  sortOrder: number;
  
  @Column({ type: 'text', nullable: true })
  notes: string;
  
  @CreateDateColumn()
  createdAt: Date;
  
  @UpdateDateColumn()
  updatedAt: Date;
  
  // Relations
  @ManyToOne(() => Product, (product) => product.variants, {
    onDelete: 'CASCADE',
  })
  @JoinColumn({ name: 'productId' })
  product: Product;
  
  @ManyToOne(() => Business, { onDelete: 'CASCADE' })
  @JoinColumn({ name: 'businessId' })
  business: Business;
  
  @OneToMany(() => InvoiceItem, (item) => item.variant)
  invoiceItems: InvoiceItem[];  // âœ¨ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§
}
```

---

### 4ï¸âƒ£ **ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± Product Entity**

```typescript
@Entity('products')
class Product {
  // ... ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ ...
  
  // âœ¨ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Variants:
  
  @Column({ type: 'boolean', default: false })
  hasVariants: boolean;           // Ø¢ÛŒØ§ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Variant Ø¯Ø§Ø±Ø¯ØŸ
  
  @Column({ type: 'decimal', precision: 15, scale: 3, default: 0 })
  totalStock: number;             // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ (Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ)
  
  // Relations
  @OneToMany(() => ProductVariant, (variant) => variant.product)
  variants: ProductVariant[];
  
  @OneToMany(() => ProductAttributeValue, (value) => value.product)
  attributeValues: ProductAttributeValue[];  // âœ¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
}
```

**Ù…Ù†Ø·Ù‚ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ:**
```typescript
calculateTotalStock(product: Product): number {
  if (!product.hasVariants) {
    return product.currentStock;  // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø®ÙˆØ¯ Ù…Ø­ØµÙˆÙ„
  }
  
  // Ø¬Ù…Ø¹ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ØªÙ…Ø§Ù… VariantÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
  return product.variants
    .filter(v => v.isActive)
    .reduce((sum, v) => sum + v.currentStock, 0);
}
```

---

### 5ï¸âƒ£ **ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± InvoiceItem Entity** âœ¨

**CRITICAL**: Ø¨Ø±Ø§ÛŒ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¯Ù‚ÛŒÙ‚ Ù…ÙˆØ¬ÙˆØ¯ÛŒ

```typescript
@Entity('invoice_items')
class InvoiceItem {
  // ... ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ ...
  
  @Column({ type: 'uuid', nullable: true })
  productId: string;             // Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
  
  // âœ¨ Ø¬Ø¯ÛŒØ¯:
  @Column({ type: 'uuid', nullable: true })
  variantId: string;             // Variant Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ (Ø§Ú¯Ø± Ø¯Ø§Ø±Ø¯)
  
  @Column({ type: 'jsonb', nullable: true })
  variantSnapshot: {             // âœ¨ Snapshot ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø¯Ø± Ø²Ù…Ø§Ù† ÙØ±ÙˆØ´
    sku: string;
    attributes: Record<string, any>;
    name?: string;
  };
  
  // Relations
  @ManyToOne(() => Product, { nullable: true, onDelete: 'SET NULL' })
  @JoinColumn({ name: 'productId' })
  product: Product;
  
  @ManyToOne(() => ProductVariant, { nullable: true, onDelete: 'SET NULL' })
  @JoinColumn({ name: 'variantId' })
  variant: ProductVariant;       // âœ¨ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Variant
}
```

**Ú†Ø±Ø§ SnapshotØŸ**
- Ø§Ú¯Ø± Variant Ø¨Ø¹Ø¯Ø§Ù‹ ØªØºÛŒÛŒØ± Ú©Ù†Ø¯ ÛŒØ§ Ø­Ø°Ù Ø´ÙˆØ¯ØŒ ÙØ§Ú©ØªÙˆØ± ØªØ§Ø±ÛŒØ®ÛŒ Ù…Ø¹ØªØ¨Ø± Ø¨Ù…Ø§Ù†Ø¯
- Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø¨Ø¨ÛŒÙ†ÛŒÙ… Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ú†Ù‡ Ú†ÛŒØ²ÛŒ ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯Ù‡

---
  
  name: string;                  // Ù†Ø§Ù… ÙˆÛŒÚ˜Ú¯ÛŒ (ÙØ§Ø±Ø³ÛŒ): "Ø±Ù†Ú¯", "Ø³Ø§ÛŒØ²"
  nameEn?: string;               // Ù†Ø§Ù… Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ: "Color", "Size"
  code: string;                  // Ú©Ø¯ ÛŒÙˆÙ†ÛŒÚ©: "color", "size"
  
  dataType: AttributeDataType;   // Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡
  
  // Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
  options?: string[];            // Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ù…Ú©Ù†: ["Ø¢Ø¨ÛŒ","Ù‚Ø±Ù…Ø²","Ø³ÙÛŒØ¯"]
  
  // Validation
  required: boolean;             // Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø¨ÙˆØ¯Ù†
  minValue?: number;             // Ø­Ø¯Ø§Ù‚Ù„ (Ø¨Ø±Ø§ÛŒ Ø¹Ø¯Ø¯)
  maxValue?: number;             // Ø­Ø¯Ø§Ú©Ø«Ø± (Ø¨Ø±Ø§ÛŒ Ø¹Ø¯Ø¯)
  pattern?: string;              // Regex pattern (Ø¨Ø±Ø§ÛŒ Ù…ØªÙ†)
  
  sortOrder: number;             // ØªØ±ØªÛŒØ¨ Ù†Ù…Ø§ÛŒØ´
  isActive: boolean;             // ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„
  
  createdAt: Date;
  updatedAt: Date;
}
```

**Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø§Ø¯Ù‡ (AttributeDataType):**
```typescript
enum AttributeDataType {
  TEXT = 'text',           // Ù…ØªÙ† Ø¢Ø²Ø§Ø¯
  NUMBER = 'number',       // Ø¹Ø¯Ø¯
  SELECT = 'select',       // Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø² Ù„ÛŒØ³Øª (ÛŒÚ©ÛŒ)
  MULTI_SELECT = 'multi_select', // Ø§Ù†ØªØ®Ø§Ø¨ Ú†Ù†Ø¯Ú¯Ø§Ù†Ù‡
  COLOR = 'color',         // Ø±Ù†Ú¯ (HEX code)
  BOOLEAN = 'boolean',     // Ø¨Ù„Ù‡/Ø®ÛŒØ±
  DATE = 'date',           // ØªØ§Ø±ÛŒØ®
}
```

---

### 2ï¸âƒ£ **ProductAttributeValue** (Ù…Ù‚Ø§Ø¯ÛŒØ± ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§)

Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ø³Ø· Ø¨Ø±Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ø§ÛŒÙ†Ú©Ù‡ ÛŒÚ© Ù…Ø­ØµÙˆÙ„ Ú†Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒÛŒ Ø¯Ø§Ø±Ø¯

```typescript
@Entity('product_attribute_values')
class ProductAttributeValue {
  id: string;                    // UUID
  productId: string;             // Ù…Ø­ØµÙˆÙ„
  attributeId: string;           // ÙˆÛŒÚ˜Ú¯ÛŒ
  
  // Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡
  textValue?: string;            // Ø¨Ø±Ø§ÛŒ TEXT
  numberValue?: number;          // Ø¨Ø±Ø§ÛŒ NUMBER
  selectValue?: string;          // Ø¨Ø±Ø§ÛŒ SELECT
  multiSelectValue?: string[];   // Ø¨Ø±Ø§ÛŒ MULTI_SELECT
  colorValue?: string;           // Ø¨Ø±Ø§ÛŒ COLOR (HEX)
  booleanValue?: boolean;        // Ø¨Ø±Ø§ÛŒ BOOLEAN
  dateValue?: Date;              // Ø¨Ø±Ø§ÛŒ DATE
  
  sortOrder: number;             // ØªØ±ØªÛŒØ¨ Ù†Ù…Ø§ÛŒØ´
  
  createdAt: Date;
  updatedAt: Date;
  
  // Relations
  product: Product;
  attribute: ProductAttribute;
}
```

---

### 3ï¸âƒ£ **ProductVariant** (ØªØ±Ú©ÛŒØ¨Ø§Øª Ù…Ø­ØµÙˆÙ„)

Ø¬Ø¯ÙˆÙ„ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ ØªØ±Ú©ÛŒØ¨Ø§Øª Ù…Ø®ØªÙ„Ù ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ + Ù…ÙˆØ¬ÙˆØ¯ÛŒ

```typescript
@Entity('product_variants')
class ProductVariant {
  id: string;                    // UUID
  productId: string;             // Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
  businessId: string;            // Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±
  
  // Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ
  sku?: string;                  // SKU Ø§Ø®ØªØµØ§ØµÛŒ Ø§ÛŒÙ† Variant
  barcode?: string;              // Ø¨Ø§Ø±Ú©Ø¯ Ø§Ø®ØªØµØ§ØµÛŒ
  
  // ØªØ±Ú©ÛŒØ¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ (JSON)
  attributes: {
    [attributeCode: string]: any;
  };
  // Ù…Ø«Ø§Ù„: { "size": "XL", "color": "Ø¢Ø¨ÛŒ", "material": "Ù¾Ù†Ø¨Ù‡" }
  
  // Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  currentStock: number;          // Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ Ø§ÛŒÙ† Variant
  minStock: number;              // Ø­Ø¯Ø§Ù‚Ù„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  reorderPoint?: number;         // Ù†Ù‚Ø·Ù‡ Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯
  
  // Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ - Ø§Ú¯Ø± Ø¨Ø§ Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ ÙØ±Ù‚ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯)
  priceAdjustment?: number;      // ØªÙØ§ÙˆØª Ù‚ÛŒÙ…Øª Ø¨Ø§ Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
  purchasePriceAdjustment?: number;
  
  // ØªØµÙˆÛŒØ± Ø§Ø®ØªØµØ§ØµÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
  image?: string;
  
  // ÙˆØ¶Ø¹ÛŒØª
  isActive: boolean;             // ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„
  status: VariantStatus;         // ÙˆØ¶Ø¹ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  
  // Ù…ØªØ§Ø¯ÛŒØªØ§
  weight?: number;               // ÙˆØ²Ù†
  dimensions?: {
    length?: number;
    width?: number;
    height?: number;
  };
  
  createdAt: Date;
  updatedAt: Date;
  
  // Relations
  product: Product;
  business: Business;
}
```

**ÙˆØ¶Ø¹ÛŒØª Variant:**
```typescript
enum VariantStatus {
  IN_STOCK = 'in_stock',           // Ù…ÙˆØ¬ÙˆØ¯
  LOW_STOCK = 'low_stock',         // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…
  OUT_OF_STOCK = 'out_of_stock',   // Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯
  DISCONTINUED = 'discontinued',    // Ù…ØªÙˆÙ‚Ù Ø´Ø¯Ù‡
}
```

---

### 4ï¸âƒ£ **ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± Product Entity**

Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ Ø¨Ø§ÛŒØ¯ Ø¨Ø¯Ø§Ù†Ø¯ Ú©Ù‡ Ø¢ÛŒØ§ Variant Ø¯Ø§Ø±Ø¯ ÛŒØ§ Ù†Ù‡:

```typescript
@Entity('products')
class Product {
  // ... ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ ...
  
  // âœ¨ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:
  
  @Column({ type: 'boolean', default: false })
  hasVariants: boolean;           // Ø¢ÛŒØ§ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Variant Ø¯Ø§Ø±Ø¯ØŸ
  
  @Column({ type: 'decimal', precision: 15, scale: 3, default: 0 })
  totalStock: number;             // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ = sum(variants.currentStock)
  
  // Relations
  @OneToMany(() => ProductVariant, variant => variant.product)
  variants: ProductVariant[];
  
  @OneToMany(() => ProductAttributeValue, value => value.product)
  attributeValues: ProductAttributeValue[];
}
```

**Ù…Ù†Ø·Ù‚:**
- Ø§Ú¯Ø± `hasVariants = false`: Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø² `currentStock` Ø®ÙˆØ¯ Ù…Ø­ØµÙˆÙ„
- Ø§Ú¯Ø± `hasVariants = true`: Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø² `totalStock` Ú©Ù‡ Ø­Ø§ØµÙ„ Ø¬Ù…Ø¹ VariantÙ‡Ø§Ø³Øª

---

## ğŸ”„ ÙÙ„ÙˆÛŒ Ú©Ø§Ø±ÛŒ (Workflow) - Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡

### Ù…Ø±Ø­Ù„Ù‡ 1: ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø±

```
1. Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ "ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§" Ù…ÛŒâ€ŒØ´ÙˆØ¯
2. ÙˆÛŒÚ˜Ú¯ÛŒ Ø§ÙˆÙ„ (Ø«Ø§Ø¨Øª - Product-level):
   - Ù†Ø§Ù…: "Ø¬Ù†Ø³"
   - Ù†ÙˆØ¹: SELECT
   - Cardinality: SINGLE (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡)
   - Scope: PRODUCT_LEVEL (Ø«Ø§Ø¨Øª)
   - Ù…Ù‚Ø§Ø¯ÛŒØ±: ["Ù¾Ù†Ø¨Ù‡", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±", "ØªØ±Ú¯Ø§Ù„"]
   
3. ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯ÙˆÙ… (Ù…ØªØºÛŒØ± - Variant-level):
   - Ù†Ø§Ù…: "Ø³Ø§ÛŒØ²"
   - Ù†ÙˆØ¹: SELECT
   - Cardinality: SINGLE (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡)
   - Scope: VARIANT_LEVEL (Ù…ØªØºÛŒØ±)
   - Ù…Ù‚Ø§Ø¯ÛŒØ±: ["S", "M", "L", "XL", "XXL"]
   
4. ÙˆÛŒÚ˜Ú¯ÛŒ Ø³ÙˆÙ… (Ù…ØªØºÛŒØ± - Variant-level):
   - Ù†Ø§Ù…: "Ø±Ù†Ú¯"
   - Ù†ÙˆØ¹: COLOR
   - Cardinality: SINGLE (ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡)
   - Scope: VARIANT_LEVEL (Ù…ØªØºÛŒØ±)
```

### Ù…Ø±Ø­Ù„Ù‡ 2: Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Variants

```
1. Ú©Ø§Ø±Ø¨Ø± Ù…Ø­ØµÙˆÙ„ "ØªÛŒâ€ŒØ´Ø±Øª Ù…Ø±Ø¯Ø§Ù†Ù‡" Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   - Ù†Ø§Ù…: ØªÛŒâ€ŒØ´Ø±Øª Ù…Ø±Ø¯Ø§Ù†Ù‡
   - Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡: 150,000
   - hasVariants = true âœ…

2. ØªØ®ØµÛŒØµ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª (Product-level):
   - Ø¬Ù†Ø³: Ù¾Ù†Ø¨Ù‡ (Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ VariantÙ‡Ø§ ÛŒÚ©Ø³Ø§Ù†)

3. Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± (Variant-level):
   - Ø³Ø§ÛŒØ² âœ…
   - Ø±Ù†Ú¯ âœ…

4. Ø§ÛŒØ¬Ø§Ø¯ Variants:
   Ø±ÙˆØ´ A: Ø¯Ø³ØªÛŒ
   - Ú©Ø§Ø±Ø¨Ø± ÛŒÚ© Ø¨Ù‡ ÛŒÚ© Variant Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   
   Ø±ÙˆØ´ B: Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ¯Ú©Ø§Ø±
   - Ø³ÛŒØ³ØªÙ… ØªÙ…Ø§Ù… ØªØ±Ú©ÛŒØ¨Ø§Øª Ù…Ù…Ú©Ù† Ø±Ø§ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
   - Ù…Ø«Ù„Ø§Ù‹: 5 Ø³Ø§ÛŒØ² Ã— 4 Ø±Ù†Ú¯ = 20 Variant
   - Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±Ø´ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨/Ø­Ø°Ù Ù…ÛŒâ€ŒÚ©Ù†Ø¯

5. Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant:
   - SKU Ø®ÙˆØ¯Ú©Ø§Ø± ÛŒØ§ Ø¯Ø³ØªÛŒ
   - Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
   - Ù‚ÛŒÙ…Øª (ÛŒØ§ ØªÙØ§ÙˆØª Ø§Ø² Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡)
   - ØªØµÙˆÛŒØ± (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
```

### Ù…Ø±Ø­Ù„Ù‡ 3: Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ

```
Ø³Ù†Ø§Ø±ÛŒÙˆ 1: ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø§Ù†Ø¨Ø§Ø±
â”œâ”€ Ú©Ø§Ø±Ø¨Ø± Variant Ø®Ø§Øµ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ù…Ø«Ù„Ø§Ù‹: Ø³Ø§ÛŒØ² LØŒ Ø±Ù†Ú¯ Ø¢Ø¨ÛŒ)
â”œâ”€ ØªØ¹Ø¯Ø§Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯: +10
â”œâ”€ variant.currentStock += 10
â”œâ”€ product.totalStock Ø¨Ø§Ø²Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â””â”€ variant.status Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯

Ø³Ù†Ø§Ø±ÛŒÙˆ 2: ÙØ±ÙˆØ´ (Ø§Ø² Ø·Ø±ÛŒÙ‚ ÙØ§Ú©ØªÙˆØ±)
â”œâ”€ Ú©Ø§Ø±Ø¨Ø± Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
â”œâ”€ Ø³ÛŒØ³ØªÙ… Ù„ÛŒØ³Øª VariantÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
â”œâ”€ Ú©Ø§Ø±Ø¨Ø± Variant Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
â”œâ”€ ØªØ¹Ø¯Ø§Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯: 2
â”œâ”€ Validation: Ø¢ÛŒØ§ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø§Ø³ØªØŸ
â”œâ”€ Ø¯Ø± InvoiceItem Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯:
â”‚  â”œâ”€ productId
â”‚  â”œâ”€ variantId âœ¨
â”‚  â””â”€ variantSnapshot âœ¨ (SKU, attributes)
â”œâ”€ Ù¾Ø³ Ø§Ø² ØªØ§ÛŒÛŒØ¯ ÙØ§Ú©ØªÙˆØ±:
â”‚  â”œâ”€ variant.currentStock -= 2
â”‚  â”œâ”€ product.totalStock Ø¨Ø§Ø²Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â”‚  â””â”€ variant.status Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯
â””â”€ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„: Ú†Ù‡ Ú†ÛŒØ²ÛŒØŒ Ú©ÛŒØŒ Ú†Ù†Ø¯ ØªØ§ ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯
```

### Ù…Ø±Ø­Ù„Ù‡ 4: Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒ

```
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© Variant
- VariantÙ‡Ø§ÛŒ Ù¾Ø±ÙØ±ÙˆØ´
- VariantÙ‡Ø§ÛŒ Ú©Ù…â€ŒÙØ±ÙˆØ´
- Ù‡Ø´Ø¯Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…
- Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯
```

---

## ğŸ“Š Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ Triggers

### 1. Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ (totalStock)

```typescript
async updateTotalStock(productId: string) {
  const product = await this.productRepository.findOne({
    where: { id: productId },
    relations: ['variants'],
  });
  
  if (!product.hasVariants) {
    // Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨Ø¯ÙˆÙ† Variant Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø®ÙˆØ¯Ø´Ø§Ù† Ø±Ø§ Ø¯Ø§Ø±Ù†Ø¯
    return;
  }
  
  // Ø¬Ù…Ø¹ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ØªÙ…Ø§Ù… VariantÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
  const totalStock = product.variants
    .filter(v => v.isActive)
    .reduce((sum, v) => sum + Number(v.currentStock), 0);
  
  await this.productRepository.update(productId, { totalStock });
}

// Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø¨Ø§ÛŒØ¯ Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø± ØªØºÛŒÛŒØ± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Variant Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯:
// - ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø§Ù†Ø¨Ø§Ø±
// - Ø®Ø±ÙˆØ¬ Ø§Ø² Ø§Ù†Ø¨Ø§Ø±
// - ÙØ±ÙˆØ´
// - Ù…Ø±Ø¬ÙˆØ¹ÛŒ
```

### 2. Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ¶Ø¹ÛŒØª Variant

```typescript
calculateVariantStatus(variant: ProductVariant): VariantStatus {
  if (!variant.isActive) {
    return VariantStatus.DISCONTINUED;
  }
  
  if (variant.currentStock <= 0) {
    return VariantStatus.OUT_OF_STOCK;
  }
  
  if (variant.currentStock <= variant.minStock) {
    return VariantStatus.LOW_STOCK;
  }
  
  return VariantStatus.IN_STOCK;
}

// Auto-update after stock changes
async afterStockChange(variantId: string) {
  const variant = await this.variantRepository.findOne({
    where: { id: variantId },
  });
  
  const newStatus = this.calculateVariantStatus(variant);
  
  if (variant.status !== newStatus) {
    await this.variantRepository.update(variantId, { status: newStatus });
    
    // Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù… Ø´Ø¯ØŒ Notification Ø¨ÙØ±Ø³Øª
    if (newStatus === VariantStatus.LOW_STOCK) {
      await this.notificationService.sendLowStockAlert(variant);
    }
  }
  
  // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
  await this.updateProductStatus(variant.productId);
}
```

### 3. Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ¶Ø¹ÛŒØª Ù…Ø­ØµÙˆÙ„

```typescript
async updateProductStatus(productId: string) {
  const product = await this.productRepository.findOne({
    where: { id: productId },
    relations: ['variants']
  });
  
  if (!product.hasVariants) {
    // Ù…Ù†Ø·Ù‚ Ù‚Ø¨Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø³Ø§Ø¯Ù‡
    const status = product.currentStock > 0 
      ? ProductStatus.ACTIVE 
      : ProductStatus.OUT_OF_STOCK;
      
    await this.productRepository.update(productId, { status });
    return;
  }
  
  // Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨Ø§ Variant
  const hasStockInAnyVariant = product.variants.some(v => 
    v.isActive && v.currentStock > 0
  );
  
  const status = hasStockInAnyVariant 
    ? ProductStatus.ACTIVE 
    : ProductStatus.OUT_OF_STOCK;
    
  await this.productRepository.update(productId, { status });
}
```

### 4. Stock Transaction (Ø±Ù‡Ú¯ÛŒØ±ÛŒ ØªØºÛŒÛŒØ±Ø§Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ)

Ø¨Ø±Ø§ÛŒ Audit Trail Ú©Ø§Ù…Ù„:

```typescript
@Entity('stock_transactions')
class StockTransaction {
  @PrimaryGeneratedColumn('uuid')
  id: string;
  
  @Column({ type: 'uuid' })
  productId: string;
  
  @Column({ type: 'uuid', nullable: true })
  variantId: string;  // âœ¨ Ø§Ú¯Ø± Ù…Ø­ØµÙˆÙ„ Variant Ø¯Ø§Ø±Ø¯
  
  @Column({
    type: 'enum',
    enum: TransactionType,
  })
  type: TransactionType;  // IN, OUT, ADJUSTMENT, RETURN
  
  @Column({ type: 'decimal', precision: 15, scale: 3 })
  quantity: number;  // + ÛŒØ§ -
  
  @Column({ type: 'decimal', precision: 15, scale: 3 })
  balanceBefore: number;
  
  @Column({ type: 'decimal', precision: 15, scale: 3 })
  balanceAfter: number;
  
  @Column({ type: 'varchar', length: 100, nullable: true })
  reference: string;  // Ø´Ù…Ø§Ø±Ù‡ ÙØ§Ú©ØªÙˆØ±ØŒ Ø±Ø³ÛŒØ¯ Ùˆ ...
  
  @Column({ type: 'text', nullable: true })
  notes: string;
  
  @CreateDateColumn()
  createdAt: Date;
  
  @Column({ type: 'uuid' })
  createdBy: string;
}

enum TransactionType {
  PURCHASE = 'purchase',        // Ø®Ø±ÛŒØ¯
  SALE = 'sale',                // ÙØ±ÙˆØ´
  RETURN = 'return',            // Ù…Ø±Ø¬ÙˆØ¹ÛŒ
  ADJUSTMENT = 'adjustment',    // ØªØ¹Ø¯ÛŒÙ„
  INITIAL = 'initial',          // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
  DAMAGE = 'damage',            // Ø¶Ø§ÛŒØ¹Ø§Øª
  TRANSFER = 'transfer',        // Ø§Ù†ØªÙ‚Ø§Ù„ (Ø§Ú¯Ø± Ú†Ù†Ø¯ Ø§Ù†Ø¨Ø§Ø± Ø¯Ø§Ø´ØªÛŒÙ…)
}
```

Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡:
- âœ… Ù‡ÛŒÚ† ØªØºÛŒÛŒØ± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø² Ø¯Ø³Øª Ù†Ù…ÛŒâ€ŒØ±ÙˆØ¯
- âœ… Ù…ÛŒâ€ŒØªÙˆØ§Ù† History Ú©Ø§Ù…Ù„ Ø±Ø§ Ø¯ÛŒØ¯
- âœ… Audit Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù…Ú©Ù† Ø§Ø³Øª
- âœ… Ø¨Ø§ Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ Ø§Ø¯ØºØ§Ù… Ø´Ø¯Ù‡

---

## ğŸ¯ Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ø´Ù…Ø§

### âœ… Ø³ÙˆØ§Ù„ 1: Ø³ÛŒØ³ØªÙ… Ø§Ù†Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒ Ø¨Ù‡ Ù‡Ù… Ù†Ù…ÛŒâ€ŒØ±ÛŒØ²Ø¯ØŸ

**Ù¾Ø§Ø³Ø®:** Ø®ÛŒØ±! Ø¨Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† `variantId` Ø¨Ù‡ `InvoiceItem`:
```typescript
// Ù‚Ø¨Ù„ (Ù…Ø­ØµÙˆÙ„Ø§Øª Ø³Ø§Ø¯Ù‡):
InvoiceItem â†’ productId â†’ Product.currentStock

// Ø¨Ø¹Ø¯ (Ø¨Ø§ Variant):
InvoiceItem â†’ productId + variantId â†’ ProductVariant.currentStock
                                   â†’ Product.totalStock (Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ)
```

**Ù…Ø²Ø§ÛŒØ§:**
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù‡Ø± Variant Ù…Ø¬Ø²Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø¯Ù‚ÛŒÙ‚: Ú†Ù‡ VariantÛŒ ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯
- History Ú©Ø§Ù…Ù„ Ø¯Ø± `StockTransaction`
- Ù…Ø­ØµÙˆÙ„Ø§Øª Ù‚Ø¯ÛŒÙ…ÛŒ (Ø¨Ø¯ÙˆÙ† Variant) Ù‡Ù…Ú†Ù†Ø§Ù† Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯

### âœ… Ø³ÙˆØ§Ù„ 2: ØªÚ© Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ vs Ú†Ù†Ø¯Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ

**Ù¾Ø§Ø³Ø®:** Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø¯Ø±Ø³Øª Ú¯ÙØªÛŒØ¯! Ø¨Ø§ `AttributeCardinality`:

```typescript
// Ù…Ø«Ø§Ù„ 1: ØªÚ© Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ
{
  name: "Ø³Ø§ÛŒØ²",
  cardinality: SINGLE,
  value: "L"  // ÙÙ‚Ø· ÛŒÚ© Ù…Ù‚Ø¯Ø§Ø±
}

// Ù…Ø«Ø§Ù„ 2: Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ
{
  name: "Ø¬Ù†Ø³",
  cardinality: MULTIPLE,
  value: ["Ù¾Ù†Ø¨Ù‡", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±"]  // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±
}

// Ù…Ø«Ø§Ù„ 3: Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ
{
  name: "Ø±Ù†Ú¯",
  cardinality: MULTIPLE,
  value: ["#000000", "#FF0000"]  // Ù…Ø´Ú©ÛŒ + Ù‚Ø±Ù…Ø²
}
```

**Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³:**
```typescript
// ProductVariant.attributes (JSONB)
{
  "size": "L",                        // ØªÚ© Ù…Ù‚Ø¯Ø§Ø±Ù‡
  "colors": ["#0000FF", "#FFFFFF"],   // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡
  "material": ["cotton", "polyester"] // Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡
}
```

### âœ… Ø³ÙˆØ§Ù„ 3: ÙˆÛŒÚ˜Ú¯ÛŒ Ø«Ø§Ø¨Øª vs Ù…ØªØºÛŒØ±

**Ù¾Ø§Ø³Ø®:** Ø¨Ø§ `AttributeScope` Ø­Ù„ Ø´Ø¯:

```
PRODUCT_LEVEL (Ø«Ø§Ø¨Øª):
â”œâ”€ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø±: ProductAttributeValue
â”œâ”€ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ VariantÙ‡Ø§ ÛŒÚ©Ø³Ø§Ù†
â””â”€ Ù…Ø«Ø§Ù„: Ø¬Ù†Ø³=Ù¾Ù†Ø¨Ù‡ØŒ Ø¨Ø±Ù†Ø¯=Nike

VARIANT_LEVEL (Ù…ØªØºÛŒØ±):
â”œâ”€ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø±: ProductVariant.attributes
â”œâ”€ Ø¯Ø± Ù‡Ø± Variant Ù…ØªÙØ§ÙˆØª
â””â”€ Ù…Ø«Ø§Ù„: Ø³Ø§ÛŒØ²ØŒ Ø±Ù†Ú¯
```

**Ù…Ø«Ø§Ù„ Ú©Ø§Ù…Ù„:**
```json
// Product
{
  "id": "prod-123",
  "name": "ØªÛŒâ€ŒØ´Ø±Øª",
  "hasVariants": true,
  "attributeValues": [
    {
      "attribute": "material",  // Ø«Ø§Ø¨Øª
      "value": "cotton"
    },
    {
      "attribute": "brand",     // Ø«Ø§Ø¨Øª
      "value": "Nike"
    }
  ]
}

// Variants
{
  "id": "var-1",
  "productId": "prod-123",
  "attributes": {
    "size": "L",      // Ù…ØªØºÛŒØ±
    "color": "#0000FF" // Ù…ØªØºÛŒØ±
  },
  "currentStock": 10
}
```

---

## âœ… Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§ÛŒÙ† Ù…Ø¹Ù…Ø§Ø±ÛŒ

### 1ï¸âƒ£ **Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„**
- Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ø± ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡ÛŒ ØªØ¹Ø±ÛŒÙ Ú©Ù†Ø¯
- ØªÚ© ÛŒØ§ Ú†Ù†Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ
- Ø«Ø§Ø¨Øª ÛŒØ§ Ù…ØªØºÛŒØ±
- Ù†ÙˆØ¹ Ø¯Ø§Ø¯Ù‡ Ø¯Ù„Ø®ÙˆØ§Ù‡

### 2ï¸âƒ£ **Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ**
- Ø¨Ø±Ø§ÛŒ Ù‡Ø²Ø§Ø±Ø§Ù† Variant Ù…Ù†Ø§Ø³Ø¨
- Index Ù…Ù†Ø§Ø³Ø¨ Ø±ÙˆÛŒ JSONB
- Query Ø¨Ù‡ÛŒÙ†Ù‡

### 3ï¸âƒ£ **Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ù‚ÛŒÙ‚**
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø³ØªÙ‚Ù„ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant
- Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„
- Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„ ØªØºÛŒÛŒØ±Ø§Øª

### 4ï¸âƒ£ **Ø§Ø¯ØºØ§Ù… Ø¨Ø§ Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§**
- `variantId` Ø¯Ø± InvoiceItem
- Snapshot ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ (ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø­ÙÙˆØ¸)
- Stock Transaction Ø¨Ø±Ø§ÛŒ Audit

### 5ï¸âƒ£ **Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ú¯Ø°Ø´ØªÙ‡**
- Ù…Ø­ØµÙˆÙ„Ø§Øª Ù‚Ø¯ÛŒÙ…ÛŒ (hasVariants=false) Ù‡Ù…Ú†Ù†Ø§Ù† Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
- Migration ØªØ¯Ø±ÛŒØ¬ÛŒ Ù…Ù…Ú©Ù† Ø§Ø³Øª
- Ø¨Ø¯ÙˆÙ† Breaking Changes

### 6ï¸âƒ£ **Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡ÛŒ Ù‚ÙˆÛŒ**
- Ú¯Ø²Ø§Ø±Ø´ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© Variant
- ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´ Ø¨Ø±Ø§Ø³Ø§Ø³ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
- Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù†ÛŒØ§Ø²

---

## ğŸš¨ Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

### 1. Transaction Management
```typescript
// Ù‡Ù…Ù‡ Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Transaction
async sellProduct(invoiceItem: CreateInvoiceItemDto) {
  return await this.dataSource.transaction(async (manager) => {
    // 1. Check stock
    const variant = await manager.findOne(ProductVariant, {
      where: { id: invoiceItem.variantId },
      lock: { mode: 'pessimistic_write' }  // Lock Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Over-selling
    });
    
    if (variant.currentStock < invoiceItem.quantity) {
      throw new Error('Insufficient stock');
    }
    
    // 2. Create invoice item
    await manager.save(InvoiceItem, invoiceItem);
    
    // 3. Update stock
    variant.currentStock -= invoiceItem.quantity;
    await manager.save(variant);
    
    // 4. Log transaction
    await manager.save(StockTransaction, {
      variantId: variant.id,
      type: TransactionType.SALE,
      quantity: -invoiceItem.quantity,
      balanceBefore: variant.currentStock + invoiceItem.quantity,
      balanceAfter: variant.currentStock,
    });
    
    // 5. Update totals
    await this.updateTotalStock(variant.productId, manager);
  });
}
```

### 2. Index Strategy
```sql
-- ProductAttribute
CREATE INDEX idx_product_attribute_business ON product_attributes(business_id);
CREATE INDEX idx_product_attribute_code ON product_attributes(code);
CREATE INDEX idx_product_attribute_scope ON product_attributes(scope);

-- ProductVariant
CREATE INDEX idx_product_variant_product ON product_variants(product_id);
CREATE INDEX idx_product_variant_sku ON product_variants(sku);
CREATE INDEX idx_product_variant_status ON product_variants(status);
CREATE INDEX idx_product_variant_attributes ON product_variants USING GIN (attributes);

-- InvoiceItem
CREATE INDEX idx_invoice_item_variant ON invoice_items(variant_id);

-- StockTransaction
CREATE INDEX idx_stock_transaction_variant ON stock_transactions(variant_id);
CREATE INDEX idx_stock_transaction_date ON stock_transactions(created_at);
```

### 3. Validation Rules
```typescript
// Ù‚Ø¨Ù„ Ø§Ø² Ø§ÛŒØ¬Ø§Ø¯ Variant
async validateVariant(dto: CreateVariantDto) {
  // 1. Check duplicate SKU
  const existing = await this.variantRepository.findOne({
    where: { sku: dto.sku }
  });
  if (existing) throw new Error('SKU already exists');
  
  // 2. Check attributes match product's variant-level attributes
  const product = await this.productRepository.findOne({
    where: { id: dto.productId },
    relations: ['attributeValues', 'attributeValues.attribute']
  });
  
  // 3. Validate attribute values
  for (const [key, value] of Object.entries(dto.attributes)) {
    const attr = await this.attributeRepository.findOne({
      where: { code: key }
    });
    
    if (!attr) throw new Error(`Attribute ${key} not found`);
    if (attr.scope !== AttributeScope.VARIANT_LEVEL) {
      throw new Error(`Attribute ${key} is not variant-level`);
    }
    
    // Validate cardinality
    if (attr.cardinality === AttributeCardinality.SINGLE) {
      if (Array.isArray(value)) {
        throw new Error(`Attribute ${key} should be single value`);
      }
    }
    
    // Validate options
    if (attr.options && !attr.allowCustomValue) {
      const validValues = attr.options.map(o => o.value);
      const valuesToCheck = Array.isArray(value) ? value : [value];
      for (const v of valuesToCheck) {
        if (!validValues.includes(v)) {
          throw new Error(`Invalid value for ${key}`);
        }
      }
    }
  }
}
```

---

## ğŸ”Œ API Endpoints Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

### Attributes Management

```
POST   /api/products/attributes              // Ø§ÛŒØ¬Ø§Ø¯ ÙˆÛŒÚ˜Ú¯ÛŒ Ø¬Ø¯ÛŒØ¯
GET    /api/products/attributes              // Ù„ÛŒØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
GET    /api/products/attributes/:id          // Ø¬Ø²Ø¦ÛŒØ§Øª ÛŒÚ© ÙˆÛŒÚ˜Ú¯ÛŒ
PUT    /api/products/attributes/:id          // ÙˆÛŒØ±Ø§ÛŒØ´ ÙˆÛŒÚ˜Ú¯ÛŒ
DELETE /api/products/attributes/:id          // Ø­Ø°Ù ÙˆÛŒÚ˜Ú¯ÛŒ
PATCH  /api/products/attributes/:id/toggle   // ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†
```

### Product Variants

```
POST   /api/products/:id/variants                    // Ø§ÛŒØ¬Ø§Ø¯ Variant Ø¬Ø¯ÛŒØ¯
GET    /api/products/:id/variants                    // Ù„ÛŒØ³Øª Variants ÛŒÚ© Ù…Ø­ØµÙˆÙ„
GET    /api/products/:id/variants/:variantId         // Ø¬Ø²Ø¦ÛŒØ§Øª ÛŒÚ© Variant
PUT    /api/products/:id/variants/:variantId         // ÙˆÛŒØ±Ø§ÛŒØ´ Variant
DELETE /api/products/:id/variants/:variantId         // Ø­Ø°Ù Variant
PATCH  /api/products/:id/variants/:variantId/stock   // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
POST   /api/products/:id/variants/bulk-create        // Ø§ÛŒØ¬Ø§Ø¯ Ú†Ù†Ø¯ Variant Ù‡Ù…Ø²Ù…Ø§Ù†
```

### Inventory Management

```
GET    /api/products/:id/inventory           // Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ (Ù‡Ù…Ù‡ Variants)
POST   /api/products/:id/recalculate-stock   // Ø¨Ø§Ø²Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„
GET    /api/products/variants/low-stock      // VariantÙ‡Ø§ÛŒ Ø¨Ø§ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…
```

---

## ğŸ“± Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ (UI/UX) Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

### ØµÙØ­Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¨ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ [â• ÙˆÛŒÚ˜Ú¯ÛŒ Ø¬Ø¯ÛŒØ¯]                        â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ Ø³Ø§ÛŒØ²                  [âœï¸] [ğŸ—‘ï¸] â”‚ â”‚
â”‚ â”‚ Ù†ÙˆØ¹: Ø§Ù†ØªØ®Ø§Ø¨ÛŒ                        â”‚ â”‚
â”‚ â”‚ Ù…Ù‚Ø§Ø¯ÛŒØ±: S, M, L, XL, XXL            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¨ Ø±Ù†Ú¯                   [âœï¸] [ğŸ—‘ï¸] â”‚ â”‚
â”‚ â”‚ Ù†ÙˆØ¹: Ø±Ù†Ú¯                            â”‚ â”‚
â”‚ â”‚ Ù…Ù‚Ø§Ø¯ÛŒØ±: [ğŸ”µ] [ğŸ”´] [âšª] [âš«]        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ØµÙØ­Ù‡ Ø§ÛŒØ¬Ø§Ø¯/ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Variants

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„: ØªÛŒâ€ŒØ´Ø±Øª                       â”‚
â”‚ Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡: 150,000 Ø±ÛŒØ§Ù„                 â”‚
â”‚                                         â”‚
â”‚ â˜‘ï¸ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø¯Ø§Ø±Ø§ÛŒ ØªÙ†ÙˆØ¹ Ø§Ø³Øª            â”‚
â”‚                                         â”‚
â”‚ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡:                  â”‚
â”‚ [x] Ø³Ø§ÛŒØ²  [x] Ø±Ù†Ú¯  [ ] Ø¬Ù†Ø³             â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“¦ ØªÙ†ÙˆØ¹â€ŒÙ‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„ (5 Ù…ÙˆØ±Ø¯)          â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ Variant 1:  S  |  Ø¢Ø¨ÛŒ   | Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 5â”‚ â”‚
â”‚ â”‚ Variant 2:  M  |  Ø¢Ø¨ÛŒ   | Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 10â”‚ â”‚
â”‚ â”‚ Variant 3:  L  |  Ø¢Ø¨ÛŒ   | Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 3â”‚ â”‚
â”‚ â”‚ Variant 4:  S  |  Ù‚Ø±Ù…Ø²  | Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 8â”‚ â”‚
â”‚ â”‚ Variant 5:  M  |  Ù‚Ø±Ù…Ø²  | Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 0â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ [â• Ø§ÙØ²ÙˆØ¯Ù† ØªÙ†ÙˆØ¹ Ø¬Ø¯ÛŒØ¯]               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ ğŸ“Š Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„: 26 Ø¹Ø¯Ø¯                   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ØµÙØ­Ù‡ ÙØ±ÙˆØ´ (Ø§Ù†ØªØ®Ø§Ø¨ Variant)

```
Ù…Ø­ØµÙˆÙ„: ØªÛŒâ€ŒØ´Ø±Øª
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø³Ø§ÛŒØ² Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:                   â”‚
â”‚ ( ) S    ( ) M    (â€¢) L    ( ) XL      â”‚
â”‚                                         â”‚
â”‚ Ø±Ù†Ú¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:                    â”‚
â”‚ ( ) ğŸ”µ Ø¢Ø¨ÛŒ   (â€¢) ğŸ”´ Ù‚Ø±Ù…Ø²  ( ) âšª Ø³ÙÛŒØ¯ â”‚
â”‚                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§: L - Ù‚Ø±Ù…Ø²                   â”‚
â”‚ Ù…ÙˆØ¬ÙˆØ¯ÛŒ: 7 Ø¹Ø¯Ø¯                          â”‚
â”‚ Ù‚ÛŒÙ…Øª: 160,000 Ø±ÛŒØ§Ù„                     â”‚
â”‚                                         â”‚
â”‚           [âœ… Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ±]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§ÛŒÙ† Ù…Ø¹Ù…Ø§Ø±ÛŒ

1. **Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ú©Ø§Ù…Ù„**: Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ø± ÙˆÛŒÚ˜Ú¯ÛŒ Ø¯Ù„Ø®ÙˆØ§Ù‡ÛŒ ØªØ¹Ø±ÛŒÙ Ú©Ù†Ø¯
2. **Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±**: Ø¨Ø±Ø§ÛŒ Ù‡Ø²Ø§Ø±Ø§Ù† Variant Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³Øª
3. **Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ù‚ÛŒÙ‚**: Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù‡Ø± ØªØ±Ú©ÛŒØ¨ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
4. **Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø®ÙˆØ¯Ú©Ø§Ø±**: Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ Ùˆ ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
5. **Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±**: Ø§Ù…Ú©Ø§Ù† Ù‚ÛŒÙ…Øª Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant
6. **Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡ÛŒ Ù‚ÙˆÛŒ**: Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ú¯Ø²Ø§Ø±Ø´Ø§Øª ØªÙØµÛŒÙ„ÛŒ Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ ÙØ±ÙˆØ´ Ú¯Ø±ÙØª
7. **Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ**: Ø¨Ø§ Ø³ÛŒØ³ØªÙ… ÙØ¹Ù„ÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø³Ø§Ø²Ú¯Ø§Ø± Ø§Ø³Øª

---

## ğŸš€ Ù…Ø±Ø§Ø­Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

### Phase 1: Database & Entities (Backend)
1. âœ¨ Ø§ÛŒØ¬Ø§Ø¯ Entity: `ProductAttribute` (ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§)
2. âœ¨ Ø§ÛŒØ¬Ø§Ø¯ Entity: `ProductAttributeValue` (ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª Ù…Ø­ØµÙˆÙ„)
3. âœ¨ Ø§ÛŒØ¬Ø§Ø¯ Entity: `ProductVariant` (ØªØ±Ú©ÛŒØ¨Ø§Øª Ù…Ø­ØµÙˆÙ„)
4. âœ¨ Ø§ÛŒØ¬Ø§Ø¯ Entity: `StockTransaction` (Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ)
5. âœ¨ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Entity: `Product` (Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† hasVariants, totalStock)
6. âœ¨ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Entity: `InvoiceItem` (Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† variantId, variantSnapshot)
7. âœ¨ Ø§ÛŒØ¬Ø§Ø¯ Migrations

### Phase 2: Backend Services
1. âœ¨ Module: `product-attributes`
   - AttributesService (CRUD ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§)
   - AttributesController
   - DTOs Ùˆ Validation

2. âœ¨ Module: `product-variants`
   - VariantsService (CRUD Variants)
   - VariantsController
   - Bulk Create Variants

3. âœ¨ Stock Management Service
   - Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ (updateTotalStock)
   - Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ¶Ø¹ÛŒØª Variant
   - Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙˆØ¶Ø¹ÛŒØª Ù…Ø­ØµÙˆÙ„
   - Ø«Ø¨Øª StockTransaction

4. âœ¨ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Invoice Service
   - Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² variantId
   - Ø°Ø®ÛŒØ±Ù‡ variantSnapshot
   - Ú©Ø³Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø§Ø² Variant

### Phase 3: API Endpoints
```
Attributes:
  POST   /api/products/attributes
  GET    /api/products/attributes
  GET    /api/products/attributes/:id
  PUT    /api/products/attributes/:id
  DELETE /api/products/attributes/:id
  PATCH  /api/products/attributes/:id/toggle

Variants:
  POST   /api/products/:id/variants
  GET    /api/products/:id/variants
  GET    /api/products/:id/variants/:variantId
  PUT    /api/products/:id/variants/:variantId
  DELETE /api/products/:id/variants/:variantId
  PATCH  /api/products/:id/variants/:variantId/stock
  POST   /api/products/:id/variants/bulk-create
  POST   /api/products/:id/variants/generate  // Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ ØªØ±Ú©ÛŒØ¨Ø§Øª

Stock:
  GET    /api/products/:id/inventory
  POST   /api/products/:id/recalculate-stock
  GET    /api/variants/low-stock
  GET    /api/stock-transactions
```

### Phase 4: Frontend (Flutter)
1. âœ¨ ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
   - Ù„ÛŒØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
   - Ø§ÙØ²ÙˆØ¯Ù†/ÙˆÛŒØ±Ø§ÛŒØ´ ÙˆÛŒÚ˜Ú¯ÛŒ
   - ØªÙ†Ø¸ÛŒÙ…Ø§Øª (DataType, Cardinality, Scope)

2. âœ¨ ØµÙØ­Ù‡ Ø§ÛŒØ¬Ø§Ø¯/ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„
   - Toggle "Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Variant Ø¯Ø§Ø±Ø¯"
   - Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
   - Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±

3. âœ¨ ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Variants
   - Ù„ÛŒØ³Øª Variants Ù…Ø­ØµÙˆÙ„
   - Ø§ÙØ²ÙˆØ¯Ù† Variant Ø¯Ø³ØªÛŒ
   - Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ±Ú©ÛŒØ¨Ø§Øª
   - ÙˆÛŒØ±Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ù‚ÛŒÙ…Øª
   - Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ±

4. âœ¨ ØµÙØ­Ù‡ ÙØ±ÙˆØ´ (Invoice)
   - Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø­ØµÙˆÙ„
   - Ø§Ú¯Ø± hasVariants: Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨Ú¯Ø± Variant
   - Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Variant
   - Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ±

5. âœ¨ ØµÙØ­Ù‡ Ú¯Ø²Ø§Ø±Ø´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
   - Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© Variant
   - VariantÙ‡Ø§ÛŒ Ú©Ù…â€ŒÙ…ÙˆØ¬ÙˆØ¯
   - ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØºÛŒÛŒØ±Ø§Øª

### Phase 5: Testing & Optimization
1. âœ¨ Unit Tests
   - AttributesService
   - VariantsService
   - StockService

2. âœ¨ Integration Tests
   - Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Variants
   - ÙØ±ÙˆØ´ Ùˆ Ú©Ø³Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ
   - Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø®ÙˆØ¯Ú©Ø§Ø±

3. âœ¨ Performance Tests
   - Query optimization
   - Index verification
   - Load testing

4. âœ¨ Documentation
   - API Documentation
   - User Guide
   - Developer Guide

---

## â“ Ø³ÙˆØ§Ù„Ø§Øª Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯

### 1ï¸âƒ£ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ùˆ Ø·Ø±Ø§Ø­ÛŒ
- âœ… Ø¢ÛŒØ§ ØªÙÚ©ÛŒÚ© ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ **Ø«Ø§Ø¨Øª** (Product-level) Ùˆ **Ù…ØªØºÛŒØ±** (Variant-level) Ø¯Ø±Ø³Øª Ø§Ø³ØªØŸ
- âœ… Ø¢ÛŒØ§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ **Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡** (Ù…Ø«Ù„: Ø¬Ù†Ø³ = ["Ù¾Ù†Ø¨Ù‡", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±"]) Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ØŸ
- âœ… Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **ØªØµÙˆÛŒØ± Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡** Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant Ù‡Ø³ØªØŸ

### 2ï¸âƒ£ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ
- âœ… Ø¢ÛŒØ§ Ù‡Ø± Variant Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ **Ù‚ÛŒÙ…Øª Ù…ØªÙØ§ÙˆØª** Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ØŸ
- âœ… ÛŒØ§ ÙÙ‚Ø· **ØªÙØ§ÙˆØª Ù‚ÛŒÙ…Øª** (Â±) Ø¨Ø§ Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯ØŸ
- **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯:** Ù‡Ø± Ø¯Ùˆ Ú¯Ø²ÛŒÙ†Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø´ÙˆØ¯ (priceAdjustment ÛŒØ§ salePrice Ù…Ø·Ù„Ù‚)

### 3ï¸âƒ£ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ø§Ù†Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒ
- âœ… Ø¢ÛŒØ§ ÙØ¹Ù„Ø§Ù‹ **ÛŒÚ© Ø§Ù†Ø¨Ø§Ø±** Ú©Ø§ÙÛŒ Ø§Ø³ØªØŸ (Ø¨Ø¹Ø¯Ø§Ù‹ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ú†Ù†Ø¯ Ø§Ù†Ø¨Ø§Ø± Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯)
- âœ… Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **Ù†Ù‚Ø·Ù‡ Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯** (reorderPoint) Ø¨Ø±Ø§ÛŒ Ù‡Ø± Variant Ù‡Ø³ØªØŸ
- âœ… Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **Ù‡Ø´Ø¯Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù…** (Low Stock Alert) Ù‡Ø³ØªØŸ

### 4ï¸âƒ£ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ UI
- âœ… Ø¢ÛŒØ§ Ø¯Ø± ÙØ±Ù… ÙØ±ÙˆØ´ØŒ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ÛŒØ¯ **Ù‡Ù…Ù‡ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø¨ÛŒÙ†Ø¯** ÛŒØ§ ÙÙ‚Ø· VariantÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†Ø¯ØŸ
- **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯:** Ù‡Ø± Ø¯Ùˆ Ø±ÙˆØ´:
  - Ø±ÙˆØ´ A: Ù„ÛŒØ³Øª VariantÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ (Ø³Ø±ÛŒØ¹â€ŒØªØ±)
  - Ø±ÙˆØ´ B: Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ùˆ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Variant (Ú©Ø§Ø±Ø¨Ø±Ù¾Ø³Ù†Ø¯ØªØ±)

### 5ï¸âƒ£ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ
- â“ Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **Import/Export Excel** Ø¨Ø±Ø§ÛŒ Variants Ù‡Ø³ØªØŸ
- â“ Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù†** ÛŒÚ© Variant Ø¨Ù‡ Variant Ø¯ÛŒÚ¯Ø± Ù‡Ø³ØªØŸ
- â“ Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØºÛŒÛŒØ± Ù‚ÛŒÙ…Øª** Variant Ù‡Ø³ØªØŸ
- â“ Ø¢ÛŒØ§ Ù†ÛŒØ§Ø² Ø¨Ù‡ **ØªØ®ÙÛŒÙ Ú¯Ø±ÙˆÙ‡ÛŒ** Ø±ÙˆÛŒ VariantÙ‡Ø§ÛŒ Ø®Ø§Øµ Ù‡Ø³ØªØŸ

### 6ï¸âƒ£ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§
- âœ… Ú¯Ø²Ø§Ø±Ø´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© Variant
- âœ… Ú¯Ø²Ø§Ø±Ø´ ÙØ±ÙˆØ´ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© Variant
- âœ… VariantÙ‡Ø§ÛŒ Ù¾Ø±ÙØ±ÙˆØ´ / Ú©Ù…â€ŒÙØ±ÙˆØ´
- â“ Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯ Ø¨Ù‡ ØªÙÚ©ÛŒÚ© VariantØŸ

### 7ï¸âƒ£ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ¹Ù„ÛŒ
- âœ… Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù…Ø­ØµÙˆÙ„Ø§Øª ÙØ¹Ù„ÛŒ **Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø³ØªÛŒ** Ø¨Ù‡ Variant ØªØ¨Ø¯ÛŒÙ„ Ø´ÙˆÙ†Ø¯ØŸ
- âœ… ÛŒØ§ **Ø®ÙˆØ¯Ú©Ø§Ø±** ØªØ¨Ø¯ÛŒÙ„ Ø´ÙˆÙ†Ø¯ (ÛŒÚ© Variant Ø¨Ø§ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ)ØŸ
- **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯:** Ø¯Ø³ØªÛŒØŒ Ú†ÙˆÙ† Ù…Ù…Ú©Ù† Ø§Ø³Øª Ú©Ø§Ø±Ø¨Ø± Ø¨Ø®ÙˆØ§Ù‡Ø¯ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†Ø¯

---

## ğŸ“ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù†Ù‡Ø§ÛŒÛŒ

### âœ… Ø´Ø±ÙˆØ¹ Ø¨Ø§ MVP (Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø­ØµÙˆÙ„ Ù‚Ø§Ø¨Ù„ Ø§Ø±Ø§Ø¦Ù‡)
Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹ØŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ù… Ø§ÙˆÙ„ Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø±Ø§ Ù¾ÛŒØ§Ø¯Ù‡ Ú©Ù†ÛŒÙ…:

**Phase 1 (MVP):**
1. ØªØ¹Ø±ÛŒÙ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ (ÙÙ‚Ø· SELECT, TEXT)
2. ØªÙÚ©ÛŒÚ© Product-level / Variant-level
3. Ø§ÛŒØ¬Ø§Ø¯ Variants Ø¯Ø³ØªÛŒ
4. Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø³ØªÙ‚Ù„ Ù‡Ø± Variant
5. Ø§Ù†ØªØ®Ø§Ø¨ Variant Ø¯Ø± ÙØ±ÙˆØ´
6. Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„

**Phase 2 (Enhanced):**
1. Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² COLOR, NUMBER, DATE
2. ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú†Ù†Ø¯ Ù…Ù‚Ø¯Ø§Ø±Ù‡ (MULTIPLE)
3. Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ¯Ú©Ø§Ø± Variants
4. ØªØµØ§ÙˆÛŒØ± Ø§Ø®ØªØµØ§ØµÛŒ Variant
5. StockTransaction Ø¨Ø±Ø§ÛŒ Audit

**Phase 3 (Advanced):**
1. Import/Export Excel
2. Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
3. Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù†ÛŒØ§Ø²
4. Ú†Ù†Ø¯ Ø§Ù†Ø¨Ø§Ø± (Ø§Ú¯Ø± Ù†ÛŒØ§Ø² Ø¨ÙˆØ¯)

### ğŸ¯ Ù…Ø²ÛŒØª Ø§ÛŒÙ† Ø±ÙˆÛŒÚ©Ø±Ø¯
- Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹ (MVP Ø¯Ø± 1-2 Ù‡ÙØªÙ‡)
- Feedback Ø²ÙˆØ¯ Ù‡Ù†Ú¯Ø§Ù… Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
- Ø§Ù…Ú©Ø§Ù† ØªØºÛŒÛŒØ± Ø·Ø±Ø§Ø­ÛŒ Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²
- Ú©Ø§Ù‡Ø´ Ø±ÛŒØ³Ú©

---

## ğŸ”¥ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø±ÙˆØ¹!

Ø§Ú¯Ø± Ø§ÛŒÙ† ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ù†ÛŒØ§Ø²ØªØ§Ù† **Ù…Ø·Ø§Ø¨Ù‚Øª Ø¯Ø§Ø±Ø¯** Ùˆ **Ø³ÙˆØ§Ù„Ø§Øª Ø¨Ø§Ù„Ø§ Ø±Ø§ Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯ÛŒØ¯**ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… **ÙÙˆØ±Ø§Ù‹ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…**:

### Ú¯Ø§Ù… Ø¨Ø¹Ø¯ÛŒ:
1. âœ… **ØªØ§ÛŒÛŒØ¯ Ù†Ù‡Ø§ÛŒÛŒ** Ø§ÛŒÙ† Ø³Ù†Ø¯
2. ğŸ”¨ Ø´Ø±ÙˆØ¹ **Phase 1: Entities & Migrations**
3. ğŸš€ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ **Backend Services**
4. ğŸ“± Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ **Flutter UI**
5. ğŸ§ª ØªØ³Øª Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ

**Ø²Ù…Ø§Ù† ØªØ®Ù…ÛŒÙ†ÛŒ Phase 1 (MVP):** 7-10 Ø±ÙˆØ² Ú©Ø§Ø±ÛŒ

---

ğŸ’¬ **Ù…Ù†ØªØ¸Ø± ØªØ§ÛŒÛŒØ¯ Ø´Ù…Ø§ Ù‡Ø³ØªÙ…!** Ù„Ø·ÙØ§Ù‹ Ø¨Ú¯ÙˆÛŒÛŒØ¯:
- Ø¢ÛŒØ§ Ø§ÛŒÙ† Ø·Ø±Ø§Ø­ÛŒ Ø±Ø§ ØªØ§ÛŒÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯?
- Ø¢ÛŒØ§ Ù¾Ø§Ø³Ø® Ø³ÙˆØ§Ù„Ø§Øª Ø¨Ø§Ù„Ø§ Ø±Ø§ Ø¯Ø§Ø±ÛŒØ¯ØŸ
- Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§Ø² MVP Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ… ÛŒØ§ Ù…Ø³ØªÙ‚ÛŒÙ… Full VersionØŸ

